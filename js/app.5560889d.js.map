{"version":3,"file":"js/app.5560889d.js","mappings":"kEAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,QAAQ,CAACA,EAAG,YAAY,CAACE,MAAM,CAAC,IAAM,GAAG,MAAQ,OAAO,KAAO,KAAK,CAACF,EAAG,MAAM,CAACG,YAAY,CAAC,QAAU,OAAO,kBAAkB,gBAAgB,MAAQ,WAAW,CAACH,EAAG,MAAM,CAACG,YAAY,CAAC,cAAc,SAAS,CAACH,EAAG,KAAK,CAACG,YAAY,CAAC,YAAY,OAAO,MAAQ,UAAU,CAACP,EAAIQ,GAAG,uDAAuDJ,EAAG,MAAM,CAACK,YAAY,sBAAsBF,YAAY,CAAC,eAAe,cAAcH,EAAG,SAAS,CAACA,EAAG,4BAA4B,GAAGA,EAAG,WAAW,CAACJ,EAAIQ,GAAG,kBAAkB,IACxlBE,EAAkB,GCDlB,EAAS,WAAa,IAAIV,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,cAAc,CAACG,YAAY,CAAC,aAAa,SAAS,CAACH,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,YAAY,CAAC,aAAa,QAAQ,eAAe,OAAO,aAAa,OAAOD,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,QAAQ,CAACE,MAAM,CAAC,MAAQ,UAAU,OAAS,SAAS,KAAO,+DAA+D,CAACN,EAAIQ,GAAG,kBAAkB,GAAGJ,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,YAAY,CAACE,MAAM,CAAC,OAAS,IAAIK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,YAAYC,GAAG,SAASC,GAC/hB,IAAIC,EAAKD,EAAIC,GACTV,EAAQS,EAAIT,MAChB,MAAO,CAACF,EAAG,QAAQ,CAACA,EAAG,eAAeJ,EAAIiB,GAAGjB,EAAIkB,GAAG,CAACZ,MAAM,CAAC,MAAQ,eAAe,SAAW,GAAG,KAAO,WAAW,MAAQ,CAAC,SAAUa,GAAI,QAASA,GAAK,iCAAmCC,MAAM,CAACC,MAAOrB,EAAe,YAAEsB,SAAS,SAAUC,GAAMvB,EAAIwB,YAAYD,GAAKE,WAAW,gBAAgB,eAAenB,GAAM,GAAOU,KAAM,GAAGZ,EAAG,QAAQ,CAACG,YAAY,CAAC,QAAU,OAAO,kBAAkB,aAAa,CAACH,EAAG,IAAI,CAACE,MAAM,CAAC,OAAS,SAAS,KAAO,0HAA0H,CAACN,EAAIQ,GAAG,kCAAkC,CAACJ,EAAG,OAAO,CAACJ,EAAIQ,GAAG,sHAAsH,IAAI,GAAGJ,EAAG,QAAQ,CAACG,YAAY,CAAC,gBAAgB,SAAS,CAACH,EAAG,QAAQ,CAACG,YAAY,CAAC,eAAe,QAAQD,MAAM,CAAC,KAAO,OAAOF,EAAG,QAAQ,CAACG,YAAY,CAAC,QAAU,KAAKD,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,SAAS,CAACW,IAAI,gBAAgBT,MAAM,CAAC,0BAAyB,EAAM,WAAa,oBAAoBK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,YAAYC,GAAG,SAASC,GAC5jC,IAAIC,EAAKD,EAAIC,GACTV,EAAQS,EAAIT,MAChB,MAAO,CAACF,EAAG,eAAeJ,EAAIiB,GAAGjB,EAAIkB,GAAG,CAACZ,MAAM,CAAC,MAAQN,EAAI0B,cAAc,MAAQ,mBAAmB,eAAe,eAAe,SAAW,KAAK,eAAepB,GAAM,GAAOU,SAAUI,MAAM,CAACC,MAAOrB,EAAiB,cAAEsB,SAAS,SAAUC,GAAMvB,EAAI2B,cAAcJ,GAAKE,WAAW,kBAAkB,CAACrB,EAAG,gBAAgB,CAACE,MAAM,CAAC,IAAMN,EAAI4B,QAAQR,MAAM,CAACC,MAAOrB,EAAoB,iBAAEsB,SAAS,SAAUC,GAAMvB,EAAI6B,iBAAiBN,GAAKE,WAAW,qBAAqB,CAACrB,EAAG,YAAYA,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,GAAG,MAAQ,WAAWU,GAAG,CAAC,MAAQ,SAASc,GAAQ9B,EAAI2B,eAAgB,KAAS,CAAC3B,EAAIQ,GAAG,cAAcJ,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,GAAG,MAAQ,WAAWU,GAAG,CAAC,MAAQ,SAASc,GAAQ,OAAO9B,EAAI+B,MAAMC,cAAcC,KAAKjC,EAAIkC,eAAe,CAAClC,EAAIQ,GAAG,WAAW,IAAI,IAAI,IAAI,GAAGJ,EAAG,QAAQ,CAACG,YAAY,CAAC,cAAc,IAAI,QAAU,OAAO,kBAAkB,WAAW,CAAEP,EAAgB,aAAE,CAACI,EAAG,QAAQ,CAACE,MAAM,CAAC,SAAW,KAAK,CAACN,EAAIQ,GAAG,IAAIR,EAAImC,GAAI,wBAA2BlC,KAAKmC,MAAY,OAAI,KAAM,OAAOhC,EAAG,oBAAoB,CAACE,MAAM,CAAC,cAAgB,GAAG,MAAQ,WAAW,CAACF,EAAG,QAAQ,CAACK,YAAY,OAAOH,MAAM,CAAC,MAAQ,UAAU,SAAWL,KAAKoC,mBAAmB,IAAMpC,KAAKuB,aAAaR,GAAG,CAAC,MAAQhB,EAAIsC,aAAa,CAACtC,EAAIQ,GAAG,6BAA6B,GAAGJ,EAAG,YAAY,CAACG,YAAY,CAAC,aAAa,UAAYP,EAAIuC,aAKvyBvC,EAAIwC,KALizB,CAACpC,EAAG,eAAe,CAACK,YAAY,cAAcH,MAAM,CAAC,QAAUN,EAAIyC,QAAQ,MAAQzC,EAAI0C,cAAc,iBAAgB,EAAM,WAAW,QAAQ,cAAc,GAAG,kBAAkB,EAAE,OAAS,QAAQ/B,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,sBAAsBC,GAAG,SAASC,GACziD,IAAI4B,EAAO5B,EAAI4B,KACf,MAAO,CAACvC,EAAG,aAAa,CAACE,MAAM,CAAC,SAAW,IAAIc,MAAM,CAACC,MAAOsB,EAAmB,eAAErB,SAAS,SAAUC,GAAMvB,EAAI4C,KAAKD,EAAM,iBAAkBpB,IAAME,WAAW,4BAA4B,CAACZ,IAAI,UAAUC,GAAG,SAASC,MAAyBf,EAAIoC,MAAY,OAAE,CAACvB,IAAI,MAAMC,GAAG,WAAW,MAAO,CAACV,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,WAAW,CAACG,YAAY,CAAC,cAAc,QAAQD,MAAM,CAAC,MAAQ,wBAAwBc,MAAM,CAACC,MAAOrB,EAAsB,mBAAEsB,SAAS,SAAUC,GAAMvB,EAAI6C,mBAAmBtB,GAAKE,WAAW,yBAAyB,GAAGrB,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,YAAY,CAACE,MAAM,CAAC,OAAS,IAAIK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,YAAYC,GAAG,SAASC,GAC9pB,IAAIC,EAAKD,EAAIC,GACTV,EAAQS,EAAIT,MAChB,MAAO,CAACF,EAAG,eAAeJ,EAAIiB,GAAGjB,EAAIkB,GAAG,CAACZ,MAAM,CAAC,MAAQ,uBAAuBc,MAAM,CAACC,MAAOrB,EAAkB,eAAEsB,SAAS,SAAUC,GAAMvB,EAAI8C,eAAevB,GAAKE,WAAW,mBAAmB,eAAenB,GAAM,GAAOU,QAAS,MAAK,EAAM,aAAa,CAACZ,EAAG,OAAO,CAACJ,EAAIQ,GAAG,8FAA8F,IAAI,KAAKuC,OAAM,GAAM,MAAM,MAAK,GAAM3B,MAAM,CAACC,MAAOrB,EAAY,SAAEsB,SAAS,SAAUC,GAAMvB,EAAIgD,SAASzB,GAAKE,WAAW,eAAyBzB,EAAIgD,SAASC,OAAO,EAAG,CAAC7C,EAAG,QAAQ,CAACK,YAAY,OAAOF,YAAY,CAAC,aAAa,QAAQD,MAAM,CAAC,MAAQ,UAAU,SAAWL,KAAKoC,mBAAmB,GAAGrB,GAAG,CAAC,MAAQ,SAASc,GAAQ,OAAO9B,EAAIkD,yBAAyB,CAA4B,IAA1BjD,KAAKoC,mBAAwB,CAACrC,EAAIQ,GAAG,oCAAoCR,EAAImC,GAAGnC,EAAIgD,SAASC,QAAQ,OAAO,CAACjD,EAAIQ,GAAG,IAAIR,EAAImC,GAAI,qBAAuBnC,EAAImD,sBAAwBnD,EAAIqC,oBAAsB,IAAMrC,EAAImD,uBAAwB,OAAO,GAAInD,EAAIqC,mBAAmB,EAAG,CAACjC,EAAG,oBAAoB,CAACE,MAAM,CAAC,MAAQ,OAAO,eAAe,IAAI,OAASN,EAAImD,sBAAwBnD,EAAIqC,oBAAoBrC,EAAImD,sBAAsB,IAAI,OAAS,KAAK,OAAS,OAAOnD,EAAIwC,MAAOxC,EAAIoC,MAAMa,OAAO,IAAMjD,EAAIuC,aAAc,CAACnC,EAAG,YAAY,CAACE,MAAM,CAAC,OAAS,IAAIK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,YAAYC,GAAG,SAASC,GACnzC,IAAIC,EAAKD,EAAIC,GACTV,EAAQS,EAAIT,MAChB,MAAO,CAACF,EAAG,QAAQJ,EAAIiB,GAAGjB,EAAIkB,GAAG,CAACT,YAAY,OAAOF,YAAY,CAAC,aAAa,QAAQD,MAAM,CAAC,MAAQ,YAAY,QAAQA,GAAM,GAAOU,GAAI,CAAChB,EAAIQ,GAAG,0BAA0B,CAACJ,EAAG,OAAO,CAACJ,EAAIQ,GAAG,yCAAyCR,EAAIwC,KAAKpC,EAAG,aAAa,CAACO,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,SAASC,GAAG,SAASC,GACjT,IAAIT,EAAQS,EAAIT,MAChB,MAAO,CAACF,EAAG,QAAQJ,EAAIkB,GAAG,CAACZ,MAAM,CAAC,MAAQ,OAAO,KAAO,IAAIU,GAAG,CAAC,MAAQ,SAASc,GAAQ9B,EAAIoD,eAAgB,KAAS,QAAQ9C,GAAM,GAAO,CAACN,EAAIQ,GAAG,kBAAkBY,MAAM,CAACC,MAAOrB,EAAiB,cAAEsB,SAAS,SAAUC,GAAMvB,EAAIoD,cAAc7B,GAAKE,WAAW,kBAAkB,CAACzB,EAAIQ,GAAG,IAAIR,EAAImC,GAAGnC,EAAIqD,cAAc,QAAQ,IAC5T,EAAkB,G,wIC4StB,yE,OACEC,OAAAA,eAAAA,EAAAA,cAAAA,C,gDAAc,KACdA,OAAAA,eAAAA,EAAAA,WAAAA,C,iDAAWC,EAAAA,EAAAA,IAAOC,EAAAA,EAAAA,GAAI,IAAIC,KAAQ,CAACC,KAAM,KAAM,gBAC/CJ,OAAAA,eAAAA,EAAAA,SAAAA,C,iDAASC,EAAAA,EAAAA,GAAO,IAAIE,KAAQ,gBAC5BH,OAAAA,eAAAA,EAAAA,iBAAAA,C,gDAAiB,KAEjBA,OAAAA,eAAAA,EAAAA,YAAAA,C,iDAAY,IACZA,OAAAA,eAAAA,EAAAA,gBAAAA,C,iDAAgB,IAuBhBA,OAAAA,eAAAA,EAAAA,UAAAA,C,gDAAU,CACR,CAACK,KAAM,MAAOtC,MAAO,QAASuC,MAAO,SAAUC,MAAO,QACtD,CAACF,KAAM,UAAWtC,MAAO,WACzB,CAACsC,KAAM,YAAatC,MAAO,oBAC3B,CAACsC,KAAM,YAAatC,MAAO,UAC3B,CAACsC,KAAM,WAAYtC,MAAO,iBAAkBwC,MAAO,QACnD,CAACF,KAAM,WAAYtC,MAAO,kBAE5BiC,OAAAA,eAAAA,EAAAA,QAAAA,C,gDAAkC,KAElCA,OAAAA,eAAAA,EAAAA,WAAAA,C,gDAAqC,KAErCA,OAAAA,eAAAA,EAAAA,gBAAAA,C,iDAAgB,IAChBA,OAAAA,eAAAA,EAAAA,eAAAA,C,gDAAe,KACfA,OAAAA,eAAAA,EAAAA,qBAAAA,C,iDAAqB,IAErBA,OAAAA,eAAAA,EAAAA,eAAAA,C,iDAAe,IACfA,OAAAA,eAAAA,EAAAA,qBAAAA,C,gDAAqB,IACrBA,OAAAA,eAAAA,EAAAA,wBAAAA,C,gDAAwB,I,EAkJ1B,OAlMqDQ,EAAAA,EAAAA,IAAAA,EAAAA,GASnDR,OAAAA,eAAIS,EAAAA,UAAA,gBAAa,C,IAAjB,WAEE,MAAO,UAAG9D,KAAK+D,SAAQ,YAAAC,OAAQhE,KAAK2B,S,4IAGtC,SAAuBsC,GACrB,OAAOX,EAAAA,EAAAA,IAAOY,EAAAA,EAAAA,GAAMD,EAAM,aAAc,IAAIT,MAAS,iBAGvDH,OAAAA,eAAIS,EAAAA,UAAA,mBAAgB,C,IAApB,WACE,OAAO9D,KAAK+D,U,IAGd,SAAqBI,GACnBnE,KAAK+D,SAAWI,G,gCAGlBd,OAAAA,eAAIS,EAAAA,UAAA,cAAW,C,IAAf,WACE,OAAO9D,KAAK6C,eAAeuB,MAAM,U,8HAuBnC,WACE,QAAKpE,KAAKuB,e,oGAMZ,SAAe8C,GACb,OAAOf,EAAAA,EAAAA,IAAOgB,EAAAA,EAAAA,GAASD,GAAO,0BAGhChB,OAAAA,eAAIS,EAAAA,UAAA,gBAAa,C,IAAjB,WACE,IAAIS,GAAI,WAAiCvE,KAAKmC,OAAK,GAInD,GAHInC,KAAK4C,qBACP2B,EAAOA,EAAKC,QAAO,SAAAC,GAAK,OAAAA,EAAEC,mBAExB1E,KAAK2E,YAAY3B,QAAUhD,KAAK2E,YAAY,GAAI,CAClD,IAAIC,EAAgB,IAAIC,KAAGC,EAAAA,EAAAA,IAAC,GAAI9E,KAAK2E,aAAW,IAChDJ,EAAOA,EAAKC,QAAO,SAAAC,GAAK,SAAcM,IAAIN,EAAEO,WAE9C,OAAOT,G,+HAGT,SAAUN,GACR,OAAOC,EAAAA,EAAAA,GAAMD,EAAM,aAAc,IAAIT,S,yGAGvC,SAAoByB,GAElB,OADAA,EAAQA,EAAMC,QAAQ,MAAO,KACtBD,EAAME,UAAU,OAClBD,QAAQ,mBAAoB,IAC5BA,QAAQ,KAAM,KAAKA,QAAQ,KAAM,QAGxC7B,OAAAA,eAAIS,EAAAA,UAAA,WAAQ,C,IAAZ,WACE,OAAO9D,KAAKoF,iBAAiBpF,KAAKuB,c,gIAGpC,W,2HACE,IAAKvB,KAAKqF,WAIR,OAHArF,KAAKmD,eAAgB,EACrBnD,KAAKoD,aAAe,uCAEpB,IAEFpD,KAAKmC,MAAQ,GACTmD,EAAetF,KAAKuF,UAAUvF,KAAK+D,UAAUyB,UAC7CC,EAAW,kHACfzF,KAAKsC,cAAe,E,4DAIZoD,OAAQ,E,iBAEC,O,sBAAA,GAAMC,IAAAA,IAAUF,EAAU,CACnCjD,QAAS,CAAC,cAAiB,UAAYxC,KAAKuB,gB,cAD9CmE,EAAWE,EAAAA,O,aAMX,O,SAFA5F,KAAKmD,eAAgB,EACrBnD,KAAKoD,aAAe,8EACpB,M,OAqBF,OAnBImB,EAAoCmB,EAASnB,KAAKnD,MACtDmD,EAAKsB,SAAQ,SAAApB,G,QACPqB,GAAmBxB,EAAAA,EAAAA,GAASG,EAAEqB,kBAAkBN,UAChDF,EAAeQ,IAGP,QAAR,EAAArB,EAAEO,cAAMY,IAAAA,OAAA,EAAAA,EAAEG,aAAaC,WAAYC,EAAKC,UAG5CD,EAAK9D,MAAMgE,KAAK,CACdC,GAAI3B,EAAE2B,GACNC,MAAOJ,EAAK9D,MAAMa,OAAS,EAC3BsD,QAAS7B,EAAE6B,QACXR,iBAAkBG,EAAKM,eAAe9B,EAAEqB,kBACxCd,QAAgB,QAAR,EAAAP,EAAEO,cAAM/D,IAAAA,OAAA,EAAAA,EAAE8E,aAAaC,UAAW,GAC1CtB,eAAgBD,EAAEC,eAClB8B,YAAa/B,EAAE+B,kBAGflC,EAAAA,EAAAA,GAASC,EAAKA,EAAKvB,OAAS,GAAG8C,kBAAkBN,UAAYF,EAC/D,OAEFG,EAAWC,EAASnB,KAAK,mBACpBkB,E,MACH,O,6CAIJzF,KAAKmD,eAAgB,EACrBnD,KAAKoD,aAAe,0DAA4DqD,E,qBAEhFzG,KAAKsC,cAAe,E,yIAIxB,WACE,IAAIoE,EAAkC1G,KAAK+C,SAASyB,QAAO,SAAAC,GAAK,OAAAA,EAAEC,kBAClE1E,KAAK2G,iBAAiBD,M,sGAGxB,SAAuBA,G,qGACfE,EAAM,IAAIC,KAChB7G,KAAKoC,mBAAqBsE,EAAM1D,OAChChD,KAAKkD,sBAAwBwD,EAAM1D,OAC/BqD,EAAQ,EACZS,QAAQC,IACJL,EAAMM,KAAI,SAAAC,GACR,OAAOtB,IAAAA,IAAU,uDAAgDsB,EAAKb,GAAE,gBAAgB,CACtF5D,QAAS,CAAC,cAAiB,UAAYyD,EAAK1E,eAC3C2F,MAAK,SAAAxB,GACN,IAAIyB,EAAezB,EAASnB,KACxB6C,EAASR,EAAIQ,OAAO,UAAIf,EAAQ,EAAE,MAAArC,OAAKiC,EAAKoB,oBAAoBX,EAAML,GAAOC,WAOjF,OANAa,EAAa/F,MAAMyE,SAAQ,SAAApB,GACnB,OAAN2C,QAAM,IAANA,GAAAA,EAAQE,KAAK7C,EAAE8C,KAAM9C,EAAE+C,aAAc,CAACC,QAAQ,OAE1C,OAANL,QAAM,IAANA,GAAAA,EAAQE,KAAK,oBAAqBI,KAAKC,UAAUjB,IACjDT,EAAK7D,uBACHiE,EACKX,SAEPwB,MAAK,WACXN,EAAIgB,cAAc,CAACC,KAAM,OAAQC,YAAa,YAAYZ,MAAK,SAAUa,GACvEC,IAAAA,OAAiBD,EAAS,+BAAuBzE,EAAAA,EAAAA,GAAO,IAAIE,KAAQ,uBAAsB,e,mHAMhG,SAAiByE,GACf,IAAIC,EAAUlI,KAAKmI,SAASF,GAC5B,OAAOC,EAAQE,O,8FAGjB,SAASH,GACP,IAAII,EAAYJ,EAAM7D,MAAM,KAAK,GAC7BqD,EAASY,EAAUnD,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KACpDoD,EAAcC,mBAAmBC,OAAOC,KAAKhB,GAAQrD,MAAM,IAAI4C,KAAI,SAAU0B,GAC/E,MAAO,KAAO,KAAOA,EAAEC,WAAW,GAAGC,SAAS,KAAKC,OAAO,MACzDC,KAAK,KAER,OAAOpB,KAAKxD,MAAMoE,MAhMDxE,GAAuB,SAD3CiF,EAAAA,IACoBjF,GAkMrB,EAlMA,CAAqDkF,EAAAA,I,IC7ToQ,I,mLCQrTC,GAAY,OACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIF,EAAeA,EAAiB,QAmBhC,IAAkBA,EAAW,CAACC,KAAI,cAAU,SAAK,eAAW,eAAW,gBAAY,aAAS,UAAM,oBAAgB,SAAK,cAAU,YAAQ,YAAQ,eAAW,aAAS,MFGrK,MAAeF,EAAAA,EAAAA,OAAW,CACxBzB,KAAM,MAEN4B,WAAY,CACVrF,wBAAuB,GAGzBS,KAAM,WAAM,MAAC,MGhD0Q,I,uCCOrR,GAAY,OACd,EACAzE,EACAW,GACA,EACA,KACA,KACA,MAIF,EAAe,EAAiB,QAQhC,IAAkB,EAAW,CAAC2I,KAAI,YAAQ,YAAQ,UAAM,M,cCvBxDJ,EAAAA,EAAAA,IAAQK,EAAAA,GAER,UAAmBA,EAAAA,EAAQ,ICD3BL,EAAAA,EAAAA,OAAAA,eAA2B,EAE3B,IAAIA,EAAAA,EAAI,CACNM,QAAO,EACPxJ,OAAQ,SAAAyJ,GAAK,OAAAA,EAAEC,MACdC,OAAO,UCRNC,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,IAOV,OAHAE,EAAoBL,GAAUM,KAAKF,EAAOD,QAASC,EAAQA,EAAOD,QAASJ,GAGpEK,EAAOD,QAIfJ,EAAoBQ,EAAIF,E,WCzBxB,IAAIG,EAAW,GACfT,EAAoBU,EAAI,SAASC,EAAQC,EAAU1J,EAAI2J,GACtD,IAAGD,EAAH,CAMA,IAAIE,EAAeC,IACnB,IAASC,EAAI,EAAGA,EAAIP,EAASpH,OAAQ2H,IAAK,CACrCJ,EAAWH,EAASO,GAAG,GACvB9J,EAAKuJ,EAASO,GAAG,GACjBH,EAAWJ,EAASO,GAAG,GAE3B,IAJA,IAGIC,GAAY,EACPC,EAAI,EAAGA,EAAIN,EAASvH,OAAQ6H,MACpB,EAAXL,GAAsBC,GAAgBD,IAAanH,OAAOyH,KAAKnB,EAAoBU,GAAGU,OAAM,SAASnK,GAAO,OAAO+I,EAAoBU,EAAEzJ,GAAK2J,EAASM,OAC3JN,EAASS,OAAOH,IAAK,IAErBD,GAAY,EACTJ,EAAWC,IAAcA,EAAeD,IAG7C,GAAGI,EAAW,CACbR,EAASY,OAAOL,IAAK,GACrB,IAAIM,EAAIpK,SACEiJ,IAANmB,IAAiBX,EAASW,IAGhC,OAAOX,EAzBNE,EAAWA,GAAY,EACvB,IAAI,IAAIG,EAAIP,EAASpH,OAAQ2H,EAAI,GAAKP,EAASO,EAAI,GAAG,GAAKH,EAAUG,IAAKP,EAASO,GAAKP,EAASO,EAAI,GACrGP,EAASO,GAAK,CAACJ,EAAU1J,EAAI2J,I,cCJ/Bb,EAAoBuB,EAAI,SAASlB,GAChC,IAAImB,EAASnB,GAAUA,EAAOoB,WAC7B,WAAa,OAAOpB,EAAO,YAC3B,WAAa,OAAOA,GAErB,OADAL,EAAoB0B,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,G,cCLRxB,EAAoB0B,EAAI,SAAStB,EAASwB,GACzC,IAAI,IAAI3K,KAAO2K,EACX5B,EAAoB6B,EAAED,EAAY3K,KAAS+I,EAAoB6B,EAAEzB,EAASnJ,IAC5EyC,OAAOoI,eAAe1B,EAASnJ,EAAK,CAAE8K,YAAY,EAAMC,IAAKJ,EAAW3K,M,cCJ3E+I,EAAoBiC,EAAI,WACvB,GAA0B,kBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAO7L,MAAQ,IAAI8L,SAAS,cAAb,GACd,MAAOrH,GACR,GAAsB,kBAAX+D,OAAqB,OAAOA,QALjB,G,cCAxBmB,EAAoB6B,EAAI,SAASO,EAAKC,GAAQ,OAAO3I,OAAO4I,UAAUC,eAAehC,KAAK6B,EAAKC,I,cCC/FrC,EAAoBsB,EAAI,SAASlB,GACX,qBAAXoC,QAA0BA,OAAOC,aAC1C/I,OAAOoI,eAAe1B,EAASoC,OAAOC,YAAa,CAAEhL,MAAO,WAE7DiC,OAAOoI,eAAe1B,EAAS,aAAc,CAAE3I,OAAO,K,cCAvD,IAAIiL,EAAkB,CACrB,IAAK,GAaN1C,EAAoBU,EAAEQ,EAAI,SAASyB,GAAW,OAAoC,IAA7BD,EAAgBC,IAGrE,IAAIC,EAAuB,SAASC,EAA4BjI,GAC/D,IAKIqF,EAAU0C,EALV/B,EAAWhG,EAAK,GAChBkI,EAAclI,EAAK,GACnBmI,EAAUnI,EAAK,GAGIoG,EAAI,EAC3B,GAAGJ,EAASoC,MAAK,SAASvG,GAAM,OAA+B,IAAxBiG,EAAgBjG,MAAe,CACrE,IAAIwD,KAAY6C,EACZ9C,EAAoB6B,EAAEiB,EAAa7C,KACrCD,EAAoBQ,EAAEP,GAAY6C,EAAY7C,IAGhD,GAAG8C,EAAS,IAAIpC,EAASoC,EAAQ/C,GAGlC,IADG6C,GAA4BA,EAA2BjI,GACrDoG,EAAIJ,EAASvH,OAAQ2H,IACzB2B,EAAU/B,EAASI,GAChBhB,EAAoB6B,EAAEa,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBC,GAAW,EAE5B,OAAO3C,EAAoBU,EAAEC,IAG1BsC,EAAqBC,KAAK,oCAAsCA,KAAK,qCAAuC,GAChHD,EAAmB/G,QAAQ0G,EAAqBO,KAAK,KAAM,IAC3DF,EAAmBzG,KAAOoG,EAAqBO,KAAK,KAAMF,EAAmBzG,KAAK2G,KAAKF,I,GC/CvF,IAAIG,EAAsBpD,EAAoBU,OAAEP,EAAW,CAAC,MAAM,WAAa,OAAOH,EAAoB,SAC1GoD,EAAsBpD,EAAoBU,EAAE0C,I","sources":["webpack://d6_batchdownloadmail/./src/App.vue?2c4a","webpack://d6_batchdownloadmail/./src/components/MailAttachmentsDownload.vue?8843","webpack://d6_batchdownloadmail/./node_modules/@vue/vue-loader-v15/lib/index.js","webpack://d6_batchdownloadmail/./src/components/MailAttachmentsDownload.vue?f171","webpack://d6_batchdownloadmail/./src/components/MailAttachmentsDownload.vue","webpack://d6_batchdownloadmail/./src/App.vue?a37c","webpack://d6_batchdownloadmail/./src/App.vue","webpack://d6_batchdownloadmail/./src/plugins/vuetify.ts","webpack://d6_batchdownloadmail/./src/main.ts","webpack://d6_batchdownloadmail/webpack/bootstrap","webpack://d6_batchdownloadmail/webpack/runtime/chunk loaded","webpack://d6_batchdownloadmail/webpack/runtime/compat get default export","webpack://d6_batchdownloadmail/webpack/runtime/define property getters","webpack://d6_batchdownloadmail/webpack/runtime/global","webpack://d6_batchdownloadmail/webpack/runtime/hasOwnProperty shorthand","webpack://d6_batchdownloadmail/webpack/runtime/make namespace object","webpack://d6_batchdownloadmail/webpack/runtime/jsonp chunk loading","webpack://d6_batchdownloadmail/webpack/startup"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-app-bar',{attrs:{\"app\":\"\",\"color\":\"#fff\",\"dark\":\"\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"justify-content\":\"space-between\",\"width\":\"2000px\"}},[_c('div',{staticStyle:{\"margin-left\":\"30px\"}},[_c('h5',{staticStyle:{\"font-size\":\"25px\",\"color\":\"black\"}},[_vm._v(\" Tải xuống hàng loạt tệp đính kèm Outlook Mail \")])]),_c('div',{staticClass:\"d-flex align-center\",staticStyle:{\"margin-right\":\"30px\"}})])]),_c('v-main',[_c('MailAttachmentsDownload')],1),_c('v-footer',[_vm._v(\" HienHoang \")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticStyle:{\"margin-top\":\"50px\"}},[_c('v-row',[_c('v-col',{staticStyle:{\"text-align\":\"right\",\"margin-right\":\"15px\",\"margin-top\":\"3px\"},attrs:{\"cols\":\"2\"}},[_c('v-btn',{attrs:{\"color\":\"primary\",\"target\":\"_blank\",\"href\":\"https://developer.microsoft.com/en-us/graph/graph-explorer\"}},[_vm._v(\" Lấy token \")])],1),_c('v-col',{attrs:{\"cols\":\"9\"}},[_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-row',[_c('v-text-field',_vm._g(_vm._b({attrs:{\"label\":\"Access token\",\"required\":\"\",\"type\":\"password\",\"rules\":[function (v){ return !!v || 'Vui lòng điền access token!'; }]},model:{value:(_vm.accessToken),callback:function ($$v) {_vm.accessToken=$$v},expression:\"accessToken\"}},'v-text-field',attrs,false),on))],1),_c('v-row',{staticStyle:{\"display\":\"flex\",\"justify-content\":\"flex-end\"}},[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://innate-rule-d91.notion.site/H-ng-d-n-l-y-Microsoft-Access-Token-cho-REST-API-31a8a72003a94f5a892a593eb9b0a683\"}},[_vm._v(\" Hướng dẫn lấy Token\")])])]}}])},[_c('span',[_vm._v(\"Mã truy cập định danh cho từng tài khoản Outlook. Giữ bí mật mã này để tránh bị truy cập tài khoản trái phép.\")])])],1)],1),_c('v-row',{staticStyle:{\"margin-bottom\":\"18px\"}},[_c('v-col',{staticStyle:{\"margin-right\":\"15px\"},attrs:{\"cols\":\"2\"}}),_c('v-col',{staticStyle:{\"padding\":\"0\"},attrs:{\"cols\":\"9\"}},[_c('v-menu',{ref:\"dateRangeMenu\",attrs:{\"close-on-content-click\":false,\"transition\":\"scale-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-text-field',_vm._g(_vm._b({attrs:{\"value\":_vm.dateRangeText,\"label\":\"Chọn khoảng ngày\",\"prepend-icon\":\"mdi-calendar\",\"readonly\":\"\"}},'v-text-field',attrs,false),on))]}}]),model:{value:(_vm.rangeDateMenu),callback:function ($$v) {_vm.rangeDateMenu=$$v},expression:\"rangeDateMenu\"}},[_c('v-date-picker',{attrs:{\"max\":_vm.toDate},model:{value:(_vm.fromDateComputed),callback:function ($$v) {_vm.fromDateComputed=$$v},expression:\"fromDateComputed\"}},[_c('v-spacer'),_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){_vm.rangeDateMenu = false}}},[_vm._v(\" Cancel \")]),_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.$refs.dateRangeMenu.save(_vm.dateRanges)}}},[_vm._v(\" OK \")])],1)],1)],1)],1),_c('v-row',{staticStyle:{\"margin-left\":\"0\",\"display\":\"flex\",\"justify-content\":\"center\"}},[(_vm.fetchingMail)?[_c('v-btn',{attrs:{\"disabled\":\"\"}},[_vm._v(\" \"+_vm._s((\"Đang tải về mail... (\" + (this.items.length) + \")\"))+\" \")]),_c('v-progress-linear',{attrs:{\"indeterminate\":\"\",\"color\":\"cyan\"}})]:[_c('v-btn',{staticClass:\"mr-4\",attrs:{\"color\":\"success\",\"disabled\":this.fetchingAttachment>0 || !this.accessToken},on:{\"click\":_vm.fetchMails}},[_vm._v(\" Tải danh sách Email \")])]],2),_c('v-divider',{staticStyle:{\"margin-top\":\"30px\"}}),(!_vm.fetchingMail)?[_c('v-data-table',{staticClass:\"elevation-1\",attrs:{\"headers\":_vm.headers,\"items\":_vm.itemsComputed,\"single-select\":false,\"item-key\":\"index\",\"show-select\":\"\",\"items-per-page\":-1,\"height\":\"50vh\"},scopedSlots:_vm._u([{key:\"item.hasAttachments\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-checkbox',{attrs:{\"disabled\":\"\"},model:{value:(item.hasAttachments),callback:function ($$v) {_vm.$set(item, \"hasAttachments\", $$v)},expression:\"item.hasAttachments\"}})]}},{key:\"item.id\",fn:function(ref){return undefined}},(_vm.items.length)?{key:\"top\",fn:function(){return [_c('v-row',[_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-switch',{staticStyle:{\"margin-left\":\"30px\"},attrs:{\"label\":\"Chỉ mail có đính kèm\"},model:{value:(_vm.onlyAttachmentMail),callback:function ($$v) {_vm.onlyAttachmentMail=$$v},expression:\"onlyAttachmentMail\"}})],1),_c('v-col',{attrs:{\"cols\":\"8\"}},[_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-text-field',_vm._g(_vm._b({attrs:{\"label\":\"Danh sách người gửi\"},model:{value:(_vm.senderMailsRaw),callback:function ($$v) {_vm.senderMailsRaw=$$v},expression:\"senderMailsRaw\"}},'v-text-field',attrs,false),on))]}}],null,false,1273527344)},[_c('span',[_vm._v(\" Danh sách mail của người gửi cần lọc, phân tách bởi dấu phẩy (,) hoặc khoảng trống. \")])])],1)],1)]},proxy:true}:null],null,true),model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}})]:_vm._e(),(_vm.selected.length>0)?[_c('v-btn',{staticClass:\"mr-4\",staticStyle:{\"margin-top\":\"15px\"},attrs:{\"color\":\"success\",\"disabled\":this.fetchingAttachment>0},on:{\"click\":function($event){return _vm.downloadAttachments()}}},[(this.fetchingAttachment===0)?[_vm._v(\" Tải danh sách đính kèm đã chọn (\"+_vm._s(_vm.selected.length)+\") \")]:[_vm._v(\" \"+_vm._s((\"Đang download... \" + (_vm.fetchingMaxAttachment - _vm.fetchingAttachment) + \"/\" + _vm.fetchingMaxAttachment))+\" \")]],2),(_vm.fetchingAttachment>0)?[_c('v-progress-linear',{attrs:{\"color\":\"teal\",\"buffer-value\":\"0\",\"value\":(_vm.fetchingMaxAttachment - _vm.fetchingAttachment)/_vm.fetchingMaxAttachment*100,\"height\":\"12\",\"stream\":\"\"}})]:_vm._e()]:(_vm.items.length>0 && !_vm.fetchingMail)?[_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"mr-4\",staticStyle:{\"margin-top\":\"15px\"},attrs:{\"color\":\"success\"}},'v-btn',attrs,false),on),[_vm._v(\" Tải đính kèm \")])]}}])},[_c('span',[_vm._v(\"Tick chọn các mail cần tải trước\")])])]:_vm._e(),_c('v-snackbar',{scopedSlots:_vm._u([{key:\"action\",fn:function(ref){\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._b({attrs:{\"color\":\"pink\",\"text\":\"\"},on:{\"click\":function($event){_vm.snackbarError = false}}},'v-btn',attrs,false),[_vm._v(\" Close \")])]}}]),model:{value:(_vm.snackbarError),callback:function ($$v) {_vm.snackbarError=$$v},expression:\"snackbarError\"}},[_vm._v(\" \"+_vm._s(_vm.snackbarText)+\" \")])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport {Vue} from \"vue-property-decorator\";\r\nimport Component from \"vue-class-component\";\r\nimport sub from 'date-fns/sub'\r\nimport {format, parse, parseISO} from \"date-fns\";\r\nimport axios, {AxiosResponse} from \"axios\";\r\nimport JSZip from 'jszip';\r\nimport FileSaver from 'file-saver';\r\n\r\n@Component\r\nexport default class MailAttachmentsDownload extends Vue {\r\n  accessToken = \"\";\r\n  fromDate = format(sub(new Date(), {days: 10}), 'yyyy-MM-dd')\r\n  toDate = format(new Date(), 'yyyy-MM-dd')\r\n  senderMailsRaw = '';\r\n\r\n  formValid = true;\r\n  rangeDateMenu = false;\r\n\r\n  get dateRangeText() {\r\n    // return `${this.changeFormatDateToView(this.dateRanges[0])} -> ${this.changeFormatDateToView(this.dateRanges[1])}`;\r\n    return `${this.fromDate} --> ${this.toDate}`;\r\n  }\r\n\r\n  changeFormatDateToView(date: string) {\r\n    return format(parse(date, 'yyyy-MM-dd', new Date()), 'dd/MM/yyyy');\r\n  }\r\n\r\n  get fromDateComputed() {\r\n    return this.fromDate;\r\n  }\r\n\r\n  set fromDateComputed(val) {\r\n    this.fromDate = val;\r\n  }\r\n\r\n  get senderMails(): string[] {\r\n    return this.senderMailsRaw.split(/[,\\s]/);\r\n  }\r\n\r\n  headers = [\r\n    {text: 'STT', value: 'index', align: 'd-none', width: '80px'},\r\n    {text: 'Tiêu đề', value: 'subject'},\r\n    {text: 'Thời gian', value: 'receivedDateTime'},\r\n    {text: 'Người gửi', value: 'sender'},\r\n    {text: 'Đính kèm', value: 'hasAttachments', width: '80px'},\r\n    {text: 'Nội dung', value: 'bodyPreview'},\r\n  ]\r\n  items: { [key: string]: any }[] = [];\r\n\r\n  selected: { [key: string]: any }[] = [];\r\n\r\n  snackbarError = false;\r\n  snackbarText = '';\r\n  onlyAttachmentMail = true;\r\n\r\n  fetchingMail = false;\r\n  fetchingAttachment = 0;\r\n  fetchingMaxAttachment = 0;\r\n\r\n  validate() {\r\n    if (!this.accessToken) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  formatDateTime(time: string) {\r\n    return format(parseISO(time), 'yyyy/MM/dd HH:mm:ss');\r\n  }\r\n\r\n  get itemsComputed() {\r\n    let data: { [key: string]: any }[] = [...this.items];\r\n    if (this.onlyAttachmentMail) {\r\n      data = data.filter(e => e.hasAttachments);\r\n    }\r\n    if (this.senderMails.length && this.senderMails[0]) {\r\n      let senderMailSet = new Set([...this.senderMails]);\r\n      data = data.filter(e => senderMailSet.has(e.sender));\r\n    }\r\n    return data;\r\n  }\r\n\r\n  parseDate(date: string) {\r\n    return parse(date, 'yyyy-MM-dd', new Date());\r\n  }\r\n\r\n  preprocessMailTitle(title: string) {\r\n    title = title.replace(/\\W+/, '_')\r\n    return title.normalize('NFD')\r\n        .replace(/[\\u0300-\\u036f]/g, '')\r\n        .replace(/đ/g, 'd').replace(/Đ/g, 'D');\r\n  }\r\n\r\n  get userMail() {\r\n    return this.getUserMailByJwt(this.accessToken);\r\n  }\r\n\r\n  async fetchMails() {\r\n    if (!this.validate()) {\r\n      this.snackbarError = true;\r\n      this.snackbarText = 'Vui lòng điền đầy đủ thông tin trước';\r\n\r\n      return;\r\n    }\r\n    this.items = [];\r\n    let fromDateTime = this.parseDate(this.fromDate).getTime();\r\n    let queryUrl = 'https://graph.microsoft.com/v1.0/me/messages?$select=sender,subject,receivedDateTime,hasAttachments,bodyPreview';\r\n    this.fetchingMail = true;\r\n    try {\r\n      // eslint-disable-next-line no-constant-condition\r\n      while (true) {\r\n        let response: AxiosResponse<any>;\r\n        try {\r\n          response = await axios.get(queryUrl, {\r\n            headers: {'Authorization': 'Bearer ' + this.accessToken}\r\n          });\r\n        } catch (e) {\r\n          this.snackbarError = true;\r\n          this.snackbarText = 'Lỗi trong quá trình lấy dữ liệu, Access Token không hợp lệ hoặc đã hết hạn.';\r\n          break;\r\n        }\r\n        let data: { [index: string]: any; }[] = response.data.value;\r\n        data.forEach(e => {\r\n          let receivedDateTime = parseISO(e.receivedDateTime).getTime();\r\n          if (fromDateTime > receivedDateTime) {\r\n            return;\r\n          }\r\n          if (e.sender?.emailAddress.address === this.userMail) {\r\n            return;\r\n          }\r\n          this.items.push({\r\n            id: e.id,\r\n            index: this.items.length + 1,\r\n            subject: e.subject,\r\n            receivedDateTime: this.formatDateTime(e.receivedDateTime),\r\n            sender: e.sender?.emailAddress.address || '',\r\n            hasAttachments: e.hasAttachments,\r\n            bodyPreview: e.bodyPreview,\r\n          });\r\n        });\r\n        if (parseISO(data[data.length - 1].receivedDateTime).getTime() < fromDateTime) {\r\n          break;\r\n        }\r\n        queryUrl = response.data['@odata.nextLink']\r\n        if (!queryUrl) {\r\n          break;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this.snackbarError = true;\r\n      this.snackbarText = 'Có lỗi xảy ra, quá trình lấy dữ liệu không hoàn thành. ' + e;\r\n    } finally {\r\n      this.fetchingMail = false;\r\n    }\r\n  }\r\n\r\n  downloadAttachments() {\r\n    let mails: { [key: string]: any }[] = this.selected.filter(e => e.hasAttachments);\r\n    this.fetchAttachments(mails);\r\n  }\r\n\r\n  async fetchAttachments(mails: { [key: string]: any }[]) {\r\n    const zip = new JSZip();\r\n    this.fetchingAttachment = mails.length;\r\n    this.fetchingMaxAttachment = mails.length;\r\n    let index = 0;\r\n    Promise.all(\r\n        mails.map(mail => {\r\n          return axios.get(`https://graph.microsoft.com/v1.0/me/messages/${mail.id}/attachments`, {\r\n            headers: {'Authorization': 'Bearer ' + this.accessToken}\r\n          }).then(response => {\r\n            let responseData = response.data;\r\n            let folder = zip.folder(`${(index + 1)}. ${this.preprocessMailTitle(mails[index].subject)}`);\r\n            responseData.value.forEach(e => {\r\n              folder?.file(e.name, e.contentBytes, {base64: true});\r\n            })\r\n            folder?.file('mail_content.json', JSON.stringify(mails));\r\n            this.fetchingAttachment--;\r\n            ++index;\r\n            return response;\r\n          })\r\n        })).then(() => {\r\n      zip.generateAsync({type: 'blob', compression: \"DEFLATE\"}).then(function (content) {\r\n        FileSaver.saveAs(content, `outlook_attachments_${format(new Date(), 'yyyy-MM-dd HH-mm-ss')}.zip`);\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  getUserMailByJwt(token) {\r\n    let payload = this.parseJwt(token)\r\n    return payload.upn;\r\n  }\r\n\r\n  parseJwt(token) {\r\n    let base64Url = token.split('.')[1];\r\n    let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n    let jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function (c) {\r\n      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n    }).join(''));\r\n\r\n    return JSON.parse(jsonPayload);\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MailAttachmentsDownload.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MailAttachmentsDownload.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MailAttachmentsDownload.vue?vue&type=template&id=97b507a4&scoped=true&\"\nimport script from \"./MailAttachmentsDownload.vue?vue&type=script&lang=ts&\"\nexport * from \"./MailAttachmentsDownload.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./MailAttachmentsDownload.vue?vue&type=style&index=0&id=97b507a4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"97b507a4\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDataTable } from 'vuetify/lib/components/VDataTable';\nimport { VDatePicker } from 'vuetify/lib/components/VDatePicker';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSnackbar } from 'vuetify/lib/components/VSnackbar';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VBtn,VCheckbox,VCol,VContainer,VDataTable,VDatePicker,VDivider,VMenu,VProgressLinear,VRow,VSnackbar,VSpacer,VSwitch,VTextField,VTooltip})\n","import mod from \"-!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[2]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[2]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=555f4158&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VFooter } from 'vuetify/lib/components/VFooter';\nimport { VMain } from 'vuetify/lib/components/VMain';\ninstallComponents(component, {VApp,VAppBar,VFooter,VMain})\n","import Vue from 'vue';\nimport Vuetify from 'vuetify/lib/framework';\n\nVue.use(Vuetify);\n\nexport default new Vuetify({\n});\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport vuetify from './plugins/vuetify'\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  vuetify,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkd6_batchdownloadmail\"] = self[\"webpackChunkd6_batchdownloadmail\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(4306); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticStyle","_v","staticClass","staticRenderFns","scopedSlots","_u","key","fn","ref","on","_g","_b","v","model","value","callback","$$v","accessToken","expression","dateRangeText","rangeDateMenu","toDate","fromDateComputed","$event","$refs","dateRangeMenu","save","dateRanges","_s","items","fetchingAttachment","fetchMails","fetchingMail","_e","headers","itemsComputed","item","$set","onlyAttachmentMail","senderMailsRaw","proxy","selected","length","downloadAttachments","fetchingMaxAttachment","snackbarError","snackbarText","Object","format","sub","Date","days","text","align","width","__extends","MailAttachmentsDownload","fromDate","concat","date","parse","val","split","time","parseISO","data","filter","e","hasAttachments","senderMails","senderMailSet_1","Set","__spreadArray","has","sender","title","replace","normalize","getUserMailByJwt","validate","fromDateTime","parseDate","getTime","queryUrl","response","axios","_a","forEach","receivedDateTime","emailAddress","address","_this","userMail","push","id","index","subject","formatDateTime","bodyPreview","e_2","mails","fetchAttachments","zip","JSZip","Promise","all","map","mail","then","responseData","folder","preprocessMailTitle","file","name","contentBytes","base64","JSON","stringify","generateAsync","type","compression","content","FileSaver","token","payload","parseJwt","upn","base64Url","jsonPayload","decodeURIComponent","window","atob","c","charCodeAt","toString","slice","join","Component","Vue","component","VBtn","components","VApp","Vuetify","vuetify","h","App","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","i","fulfilled","j","keys","every","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}